#!/bin/sh
#
########################################################################
# Auto PowerOff (for HP ProLiant ML115)
#
#  Maintainer: id774 <idnanashi@gmail.com>
#
#  v0.1 10/21,2007
#       New.
########################################################################
JOBLOG=/var/log/auto-poweroff

echo -n "*** $0: Job start at `/bin/hostname` on ">>$JOBLOG 2>&1
date "+%Y/%m/%d %T">>$JOBLOG 2>&1

test -d /home/ubuntu/mnt/tc/doc || echo "*** $0: Machine is online now, Going to shutdown.">>$JOBLOG 2>&1

echo -n "*** $0: End of Job at `/bin/hostname` on ">>$JOBLOG 2>&1
date "+%Y/%m/%d %T">>$JOBLOG 2>&1
echo>>$JOBLOG 2>&1

# ADMIN_MAIL_ADDRESS=xxxxxx@gmail.com
case "$ADMIN_MAIL_ADDRESS" in
  *@*)
    cat $JOBLOG | mail -s "[cron-log][`/bin/hostname`] Auto PowerOff Log" $ADMIN_MAIL_ADDRESS
    ;;
esac

test -d /home/ubuntu/mnt/tc/doc || shutdown -h 1
